```js
class Solution {
    public int dfs(int[] prices,int can_buy,int index,int[][] dp){
        if(index>=prices.length)return 0;
        if(dp[index][can_buy]!=-1)return dp[index][can_buy]; 
        int maxi = 0;
        if(can_buy==1){
            int buy = dfs(prices,0,index+1,dp)-prices[index];
            int not_buy = dfs(prices,1,index+1,dp);
            maxi = Math.max(buy,not_buy);
        }else{
            int sell = dfs(prices,1,index+2,dp)+prices[index];
            int not_sell = dfs(prices,0,index+1,dp);
            maxi = Math.max(sell,not_sell);
        }
        dp[index][can_buy] = maxi;
        return maxi;
    } 
    public int maxProfit(int[] prices) {
        int n = prices.length; 
        int[][] dp = new int[n][2];
        for(int i=0;i<n;i++)Arrays.fill(dp[i],-1);
        return dfs(prices,1,0,dp);
    }
}

```